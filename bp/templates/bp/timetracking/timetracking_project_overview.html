{% extends "bp/base_tl.html" %}

{% block breadcrumbs %}
    <li class="breadcrumb-item"><a href="{% url "bp:index" %}">Übersicht</a></li>
    <li class="breadcrumb-item"><a href="{% url "bp:timetracking_tl_start" %}">Zeiterfassung</a></li>
    <li class="breadcrumb-item active">{{ project.nr }}: {{ project.title }}</li>
{% endblock %}

{% block imports %}
    <style>
        @media only print {
            body { visibility: hidden; }
            .printthis { visibility: visible; }
        }
    </style>
{% endblock %}


{% block student_content %}
{% block tl_content %}
{% block orga_content %}
    <h3 class="my-4 printthis">{{ project.nr }}: {{ project.title }}</h3>
<ul class="nav nav-tabs">
	    <li class="nav-item">
	        <a class="nav-link active" data-toggle="tab"
	           href="#g_1">
	            Überblick
	        </a>
	    </li>
	    <li class="nav-item">
	        <a class="nav-link" data-toggle="tab"
	           href="#g_2">
	            Diagramme
	        </a>
	    </li>
</ul>

<div id="myTabContent" class="tab-content">

	    <div class="tab-pane fade active show" id="g_1">
		    <div class="float-right mb-4">
		        <button class="btn btn-info" onclick="window.print()">Zeiterfassung für Moodle exportieren</button>
		    </div>
		    <h4 class="mt-3 printthis">Überblick ({{ total_hours }}h / {{ project.expected_hours }}h)</h4>
		    <div id="tt_table" class="printthis">
		        {% include "bp/timetracking/render_timetracking_overview.html" with project=project timetable=timetable %}
		    </div>
	    </div>
	    <div class="tab-pane fade" id="g_2">
	        <br>
            <h5>Zeitaufwand nach Intervall (Stunden pro Tag)</h5>
		    <canvas id="statusPerInterval" width="100%" height="15vh" class="mb-5"></canvas>
	        <br>
            <h5>Vergleich bisheriger Zeitaufwand</h5>
            {% for data in hours_per_group_data %}
                <h6>{{ data.category_name }}</h6>
                <canvas id="statusGroupComparison{{ data.chart_id }}" width="100%" height="15vh" class="mb-5"></canvas>
            {% endfor %}
		    <script>
		        new Chart($('#statusPerInterval'), {
		            type: 'line',
		            data: {
		                datasets: [{
		                    label: 'Normalised hours in interval',
		                    data: {{hours_per_interval|safe}},
		                    backgroundColor: '#1F9BCF',
		                    borderColor: '#1F9BCF',
		                    borderWidth: 1
		                }]
		            },
		            options: {
		                scales: {
		                    y: {
		                        suggestedMin: 0,
		                        suggestedMax: 8
		                    }
		                },
		                plugins: {
		                    legend: {
		                        display: false
		                    }
		                }
		            }
		        });
                {% for data in hours_per_group_data %}
                    new Chart($('#statusGroupComparison{{ data.chart_id }}'), {
                        type: 'bar',
                        data: {
                            datasets: [{
                                label: 'Normalised hours in interval',
                                data: {{data.data|safe}},
                                backgroundColor: {{data.colors|safe}},
                                borderColor: {{data.colors|safe}},
                                borderWidth: 1
                            }]
                        },
                        options: {
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                {% endfor %}
		    </script>
	    </div>
</div>

{% endblock %}
{% endblock %}
{% endblock %}
